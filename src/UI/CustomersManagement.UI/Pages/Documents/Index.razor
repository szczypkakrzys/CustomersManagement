@page "/documents"

<h3>Dokumenty</h3>

@* <div class="m-2 d-flex justify-content-end">
    <button @onclick="UploadDocument" class="btn btn-success">Dodaj nowy dokument</button>
</div> *@

@*todo:
    - find why I get here Something went wrong. message after every successful document generation
*@
@* @if (string.IsNullOrEmpty(Message) == false)
{
    <div class="alert alert-danger">
        @Message
    </div>
} *@

@if (documents == null)
{
    <p>Ładowanie danych...</p>
}
else
{
    <table class="table">

        <thead>
            <tr>
                <th>
                    Nazwa dokumentu
                </th>
                <th>
                    Akcje
                </th>
            </tr>
        </thead>

        <tbody>
            <button @onclick="UploadDocument" class="btn btn-warning">Dodaj nowy dokument</button>

            @foreach (var document in documents)
            {
                <tr>
                    <td>@document.FileName</td>
                    <td>
                      
                         <button @onclick="@(() => Download(document.Id, document.FileName))" class="btn btn-warning">Pobierz</button>
                        @if (!showCustomers)
                        {
                            <button @onclick="@(() => LoadCustomers())" class="btn btn-info">Wypełnij</button>
                        }
                        else
                        {
                            <button @onclick="@(() => LoadCustomers())" class="btn btn-info">Wróć</button>
                        }
                        <a class="btn btn-outline-primary" href="/DaneKlienta.pdf" target="_blank">Podgląd dokumentu</a>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                            Launch static backdrop modal
                        </button>
                        @* "C:\Users\Krzysiek\repos\CustomersManagement\src\TmpFilesStore\Templates\DaneKlienta.pdf" *@
                        @*<button @onclick="@(() => DeleteCustomer(customer.Id))" class="btn btn-danger">Usuń</button> *@
                    </td>
                </tr>

                @*todo:
        create method that will show the view and will return id of choosen user so it can be used in GenerateDocumentForCustomer() method
                *@
                @if (showCustomers)
                {
                    <tr>
                        @if (customers.Count == 0)
                        {
                            <p>Ładowanie danych...</p>
                        }

                        @foreach (var customer in customers)
                        {
                            @* todo: add search bar *@
                            <tr>
                            <td>@customer.FirstName @customer.LastName</td>
                                <td>
                                    <button @onclick="@(() => GenerateDocumentForCustomer(@document.FileName, @customer.Id))" class="btn btn-warning">Wybierz</button>
                                    @* document id customer id *@
                                </td>
                            </tr>
                        }
                    </tr>
                    
                }      
            }
        </tbody>

    </table>
}


<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row h-100">
                    <div class="col-sm-7">
                        <embed src="/DaneKlienta.pdf" class="w-100 h-100" />
                    </div>
                    <div class="col">
                        <div class="w-50 h-100">
                            test
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Understood</button>
            </div>
        </div>
    </div>
</div>


